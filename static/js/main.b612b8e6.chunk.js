(this.webpackJsonptest=this.webpackJsonptest||[]).push([[0],{30:function(e,t,c){},38:function(e,t,c){},39:function(e,t,c){},40:function(e,t,c){},41:function(e,t,c){},42:function(e,t,c){},43:function(e,t,c){},44:function(e,t,c){},45:function(e,t,c){"use strict";c.r(t);var a=c(4),n=c(2),s=c.n(n),i=c(15),o=c.n(i);c(30);var r=c(8),u=c(13),l=u.a.initializeApp({apiKey:"AIzaSyD5bdPxGZsmLfsP-buA2IVsVqUOg1OCe2Y",authDomain:"test-2-692c5.firebaseapp.com",projectId:"test-2-692c5",storageBucket:"test-2-692c5.appspot.com",messagingSenderId:"750578086901",appId:"1:750578086901:web:a05f894043fedc80f726bc",measurementId:"G-HXPGJ0GLBX"}).firestore(),d=u.a.auth(),j=new u.a.auth.GoogleAuthProvider,b=(c(38),c(9));c(39),c(40);var h=Object(r.b)((function(e){return{user:e.main.user}}))((function(e){e.id;var t=e.data,c=e.user;return Object(a.jsxs)("div",{className:c.id===t.senderId?"sender-message":"message",children:[Object(a.jsx)("span",{children:Object(a.jsx)("img",{src:t.senderPhoto,alt:""})}),Object(a.jsx)("div",{className:"message-info",children:t.content})]})}));var m=Object(r.b)((function(e){return{chatName:e.main.chatName,chatId:e.main.chatId,user:e.main.user}}))((function(e){var t=e.chatName,c=e.chatId,s=e.user,i=Object(n.useState)(""),o=Object(b.a)(i,2),r=o[0],d=o[1],j=Object(n.useState)([]),m=Object(b.a)(j,2),O=m[0],f=m[1],p=Object(n.useState)(""),g=Object(b.a)(p,2);return g[0],g[1],Object(n.useEffect)((function(){c&&l.collection("chats").doc(c).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){f(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[c]),Object(n.useEffect)((function(){if(0!==O.length){var e=O[0].data.content,t=O[0].data.senderPhoto;l.collection("chats").doc(c).update({theLastMessage:e,img:t})}}),[O]),Object(a.jsxs)("div",{className:"chat",children:[Object(a.jsx)("div",{className:"chat-top-bar",children:Object(a.jsx)("span",{children:t})}),Object(a.jsx)("div",{className:"chat-middle-part",children:O.map((function(e){return Object(a.jsx)(h,{id:e.id,data:e.data})}))}),t?Object(a.jsx)("div",{className:"chat-bottom-part",children:Object(a.jsx)("form",{onSubmit:function(e){e.preventDefault(),l.collection("chats").doc(c).collection("messages").add({timestamp:u.a.firestore.FieldValue.serverTimestamp(),content:r,senderId:s.id,senderPhoto:s.photo,senderEmail:s.email,senderName:s.id}),d("")},children:Object(a.jsx)("input",{value:r,onChange:function(e){return d(e.target.value)},type:"text"})})}):""]})}));c(41),c(42);var O=Object(r.b)(null,{selectChat:function(e,t){return function(c){c({type:"SELECT_CHAT",payload:{id:e,name:t}})}}})((function(e){var t=e.id,c=e.chatName,n=e.selectChat,s=e.lastMessage,i=e.img;return Object(a.jsxs)("div",{className:"single-chat",onClick:function(){n(t,c)},children:[Object(a.jsx)("a",{href:"",children:Object(a.jsx)("img",{src:i,alt:""})}),Object(a.jsxs)("div",{className:"single-chat-info",children:[Object(a.jsx)("p",{children:c}),Object(a.jsx)("h5",{children:s})]})]})}));c(43);var f=function(e){var t=e.open,c=e.setOpen,s=Object(n.useState)(""),i=Object(b.a)(s,2),o=i[0],r=i[1],u=Object(n.useState)(!1),d=Object(b.a)(u,2),j=d[0],h=d[1],m=Object(n.useState)(""),O=Object(b.a)(m,2),f=O[0],p=O[1];return Object(n.useEffect)((function(){l.collection("chats").get().then((function(e){e.docs.some((function(e){return e.data().chatName===o}))?(h(!1),p("not avilable")):""===o?(h(!1),p("this input can not be empty")):(h(!0),p(""))}))}),[o]),Object(a.jsx)("div",{className:"add-chat ".concat(!1===t?"remove":""),children:Object(a.jsxs)("div",{className:"input-box",children:[Object(a.jsx)("div",{className:"close",onClick:function(){c(!1)},children:Object(a.jsx)("i",{class:"far fa-times-circle"})}),Object(a.jsx)("form",{onSubmit:function(e){e.preventDefault(),j&&(l.collection("chats").add({chatName:o,theLastMessage:null,img:null}),r(""),c(!1))},children:Object(a.jsx)("input",{value:o,onChange:function(e){r(e.target.value)},placeholder:"chat name",type:"text"})}),Object(a.jsx)("div",{className:"validation-error",children:f})]})})};var p=Object(r.b)((function(e){return{user:e.main.user}}))((function(e){var t=e.user,c=Object(n.useState)([]),s=Object(b.a)(c,2),i=s[0],o=s[1],r=Object(n.useState)(!1),u=Object(b.a)(r,2),j=u[0],h=u[1],m=Object(n.useState)(""),p=Object(b.a)(m,2),g=p[0],v=p[1];return Object(n.useEffect)((function(){l.collection("chats").onSnapshot((function(e){o(e.docs.map((function(e){return{id:e.id,chatName:e.data().chatName,last:e.data().theLastMessage,img:e.data().img}})))}))}),[]),Object(a.jsxs)("div",{className:"side-bar",children:[Object(a.jsx)(f,{setOpen:h,open:j}),Object(a.jsxs)("div",{className:"top-bar",children:[Object(a.jsx)("img",{src:t.photo,alt:"logOut",onClick:function(){d.signOut()}}),Object(a.jsx)("input",{value:g,onChange:function(e){v(e.target.value)},type:"text"}),Object(a.jsx)("span",{onClick:function(){return h(!0)},children:Object(a.jsx)("i",{class:"fa fa-plus-square","aria-hidden":"true"})})]}),Object(a.jsx)("div",{className:"bottom-part",children:""===g?i.map((function(e){return Object(a.jsx)(O,{img:e.img,user:t,id:e.id,chatName:e.chatName,lastMessage:e.last})})):i.filter((function(e){return e.chatName===g})).map((function(e){return Object(a.jsx)(O,{img:e.img,user:t,id:e.id,chatName:e.chatName,lastMessage:e.last})}))})]})}));function g(){return Object(a.jsxs)("div",{className:"chat-container",children:[Object(a.jsx)(p,{}),Object(a.jsx)(m,{})]})}c(44);var v=function(){return Object(a.jsx)("div",{className:"login",children:Object(a.jsx)("button",{onClick:function(){d.signInWithPopup(j).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))},children:"login"})})};var x=Object(r.b)((function(e){return{user:e.main.user}}),{logIn:function(e){return function(t){t({type:"LOGIN",payload:e})}},logOut:function(){return function(e){e({type:"LOGOUT"})}}})((function(e){var t=e.logIn,c=e.logOut,s=e.user;return Object(n.useEffect)((function(){d.onAuthStateChanged((function(e){e?t({name:e.displayName,email:e.email,id:e.uid,photo:e.photoURL}):c()}))}),[]),Object(a.jsx)("div",{className:"App",children:s?Object(a.jsx)(g,{}):Object(a.jsx)(v,{})})})),N=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,46)).then((function(t){var c=t.getCLS,a=t.getFID,n=t.getFCP,s=t.getLCP,i=t.getTTFB;c(e),a(e),n(e),s(e),i(e)}))},S=c(10),y=c(23),I=c(24),C=c(12),L={user:null,chatId:null,chatName:null},E=Object(S.combineReducers)({main:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(C.a)(Object(C.a)({},e),{},{user:t.payload});case"LOGOUT":return Object(C.a)(Object(C.a)({},e),{},{user:null});case"SELECT_CHAT":return Object(C.a)(Object(C.a)({},e),{},{chatId:t.payload.id,chatName:t.payload.name});default:return e}}}),P=[I.a],T=Object(S.createStore)(E,{},Object(y.composeWithDevTools)(S.applyMiddleware.apply(void 0,P)));o.a.render(Object(a.jsx)(r.a,{store:T,children:Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(x,{})})}),document.getElementById("root")),N()}},[[45,1,2]]]);
//# sourceMappingURL=main.b612b8e6.chunk.js.map